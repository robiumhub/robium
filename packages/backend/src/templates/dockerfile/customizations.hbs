# Customizations layer ARG BASE={{baseImage}}
FROM ${BASE} WORKDIR
{{workdir}}

# UDEV rules
{{#if udevRules.length}}
  RUN
  {{#each udevRules}}echo '{{this}}' | tee /etc/udev/rules.d/{{@index}}-robium.rules
    &&
  {{/each}}
  true
{{/if}}

# Custom files
{{#each files}}
  RUN printf %s '{{{contentsEscaped}}}' >
  {{path}}
{{/each}}

# User setup and aliases RUN useradd -m -s /bin/bash
{{user}}
&& chown -R
{{user}}:{{user}}
{{workdir}}
RUN echo "source /opt/ros/{{rosDistro}}/setup.bash" >> /home/{{user}}/.bashrc
{{#each bashrcAliases}}
  RUN echo "{{this}}" >> /home/{{user}}/.bashrc
{{/each}}

# Environment variables
{{#each env}}ENV
  {{@key}}={{this}}
{{/each}}

# Expose ports
{{#each expose}}EXPOSE
  {{this}}
{{/each}}

# Switch to user USER
{{user}}

# Default command CMD ["tail", "-f", "/dev/null"]
