{
  "$schema": "http://json-schema.org/draft-2020-12/schema#",
  "title": "Robium ROS2 Package Specifications Schema",
  "description": "Schema for ROS2 package configuration including task categories, algorithm selections, package dependencies, and build configurations",
  "type": "object",
  "required": ["name", "version", "taskCategory", "algorithms", "dependencies"],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "pattern": "^[a-zA-Z0-9_-]+$",
      "description": "ROS2 package name"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.-]+)?(\\+[a-zA-Z0-9.-]+)?$",
      "description": "Package version in semantic versioning format"
    },
    "taskCategory": {
      "type": "string",
      "enum": [
        "actuator",
        "camera", 
        "remote_control",
        "arm_control",
        "voice_control",
        "mapping",
        "localization",
        "planning",
        "person_tracking",
        "person_recognition",
        "character_animation",
        "navigation",
        "manipulation",
        "perception",
        "communication",
        "safety",
        "monitoring",
        "custom"
      ],
      "description": "Primary task category for this package"
    },
    "algorithms": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "name", "description", "taskDefinition", "inputOutput"],
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100,
            "description": "Algorithm name"
          },
          "description": {
            "type": "string",
            "minLength": 1,
            "maxLength": 500,
            "description": "Detailed description of the algorithm"
          },
          "taskDefinition": {
            "type": "string",
            "minLength": 1,
            "maxLength": 1000,
            "description": "Clear definition of what task this algorithm performs"
          },
          "inputOutput": {
            "type": "object",
            "required": ["inputs", "outputs"],
            "properties": {
              "inputs": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": ["name", "type", "description"],
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 50,
                      "description": "Input parameter name"
                    },
                    "type": {
                      "type": "string"
                    },
                    "description": {
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 200,
                      "description": "Description of the input parameter"
                    },
                    "required": {
                      "type": "boolean",
                      "default": true,
                      "description": "Whether this input is required"
                    },
                    "default": {
                      "description": "Default value for the input"
                    }
                  },
                  "additionalProperties": false
                },
                "description": "List of input parameters for the algorithm"
              },
              "outputs": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": ["name", "type", "description"],
                  "properties": {
                    "name": {
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 50,
                      "description": "Output parameter name"
                    },
                    "type": {
                      "type": "string"
                    },
                    "description": {
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 200,
                      "description": "Description of the output parameter"
                    }
                  },
                  "additionalProperties": false
                },
                "description": "List of output parameters from the algorithm"
              }
            },
            "additionalProperties": false
          },
          "parameters": {
            "type": "object",
            "description": "Configurable parameters for the algorithm",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["string", "number", "boolean", "array", "object"],
                  "description": "Parameter data type"
                },
                "description": {
                  "type": "string",
                  "description": "Parameter description"
                },
                "default": {
                  "description": "Default value"
                },
                "min": {
                  "type": "number",
                  "description": "Minimum value for numeric parameters"
                },
                "max": {
                  "type": "number",
                  "description": "Maximum value for numeric parameters"
                },
                "options": {
                  "type": "array",
                  "description": "Valid options for the parameter"
                }
              },
              "required": ["type", "description"]
            }
          },
          "performance": {
            "type": "object",
            "properties": {
              "cpuUsage": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "description": "Estimated CPU usage percentage"
              },
              "memoryUsage": {
                "type": "number",
                "minimum": 0,
                "description": "Estimated memory usage in MB"
              },
              "latency": {
                "type": "number",
                "minimum": 0,
                "description": "Estimated processing latency in milliseconds"
              }
            },
            "additionalProperties": false
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50
            },
            "description": "Tags for categorizing the algorithm"
          }
        },
        "additionalProperties": false
      },
      "description": "List of algorithms available in this package"
    },
    "dependencies": {
      "type": "object",
      "required": ["ros2_packages", "system_packages"],
      "properties": {
        "ros2_packages": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "description": "List of required ROS2 packages"
        },
        "system_packages": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "description": "List of required system packages"
        },
        "python_packages": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "version"],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1,
                "maxLength": 100,
                "description": "Python package name"
              },
              "version": {
                "type": "string",
                "description": "Required version constraint"
              }
            },
            "additionalProperties": false
          },
          "description": "List of required Python packages with version constraints"
        }
      },
      "additionalProperties": false
    },
    "build": {
      "type": "object",
      "properties": {
        "buildType": {
          "type": "string",
          "enum": ["ament_cmake", "ament_python", "cmake"],
          "default": "ament_cmake",
          "description": "Build system type"
        },
        "buildArgs": {
          "type": "object",
          "description": "Additional build arguments",
          "additionalProperties": {
            "type": "string"
          }
        },
        "installTargets": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Specific targets to install"
        }
      },
      "additionalProperties": false
    },
    "launch": {
      "type": "object",
      "properties": {
        "launchFiles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1,
            "maxLength": 200
          },
          "description": "List of launch file paths"
        },
        "defaultLaunchFile": {
          "type": "string",
          "minLength": 1,
          "maxLength": 200,
          "description": "Default launch file to use"
        }
      },
      "additionalProperties": false
    },
    "configuration": {
      "type": "object",
      "description": "Package-specific configuration options",
      "additionalProperties": true
    },
    "documentation": {
      "type": "object",
      "properties": {
        "readme": {
          "type": "string",
          "description": "Path to README file"
        },
        "api": {
          "type": "string",
          "description": "Path to API documentation"
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of example file paths"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
} 