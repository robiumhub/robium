{
  "$schema": "http://json-schema.org/draft-2020-12/schema#",
  "title": "Robium Simulation Configuration Schema",
  "description": "Schema for simulation parameters, world configurations, robot models, and simulation-specific settings",
  "type": "object",
  "required": ["world", "robots", "physics"],
  "properties": {
    "world": {
      "type": "object",
      "required": ["name", "file"],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100,
          "description": "World name"
        },
        "file": {
          "type": "string",
          "minLength": 1,
          "maxLength": 500,
          "description": "Path to world file (.world)"
        },
        "description": {
          "type": "string",
          "maxLength": 500,
          "description": "World description"
        },
        "environment": {
          "type": "object",
          "properties": {
            "lighting": {
              "type": "object",
              "properties": {
                "ambient": {
                  "type": "array",
                  "items": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  },
                  "minItems": 3,
                  "maxItems": 4,
                  "description": "Ambient light color (RGB or RGBA)"
                },
                "directional": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["direction", "color", "intensity"],
                    "properties": {
                      "direction": {
                        "type": "array",
                        "items": {
                          "type": "number"
                        },
                        "minItems": 3,
                        "maxItems": 3,
                        "description": "Light direction vector"
                      },
                      "color": {
                        "type": "array",
                        "items": {
                          "type": "number",
                          "minimum": 0,
                          "maximum": 1
                        },
                        "minItems": 3,
                        "maxItems": 4,
                        "description": "Light color (RGB or RGBA)"
                      },
                      "intensity": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 10,
                        "description": "Light intensity"
                      }
                    },
                    "additionalProperties": false
                  },
                  "description": "Directional light sources"
                }
              },
              "additionalProperties": false
            },
            "gravity": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "minItems": 3,
              "maxItems": 3,
              "default": [0, 0, -9.81],
              "description": "Gravity vector (x, y, z)"
            },
            "skybox": {
              "type": "string",
              "description": "Path to skybox texture"
            },
            "ground": {
              "type": "object",
              "properties": {
                "texture": {
                  "type": "string",
                  "description": "Path to ground texture"
                },
                "friction": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "default": 0.8,
                  "description": "Ground friction coefficient"
                },
                "restitution": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "default": 0.1,
                  "description": "Ground restitution coefficient"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "objects": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "type", "pose"],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1,
                "maxLength": 100,
                "description": "Object name"
              },
              "type": {
                "type": "string",
                "enum": ["box", "sphere", "cylinder", "mesh", "plane"],
                "description": "Object geometry type"
              },
              "pose": {
                "type": "object",
                "required": ["position", "orientation"],
                "properties": {
                  "position": {
                    "type": "array",
                    "items": {
                      "type": "number"
                    },
                    "minItems": 3,
                    "maxItems": 3,
                    "description": "Position (x, y, z)"
                  },
                  "orientation": {
                    "type": "array",
                    "items": {
                      "type": "number"
                    },
                    "minItems": 4,
                    "maxItems": 4,
                    "description": "Orientation quaternion (x, y, z, w)"
                  }
                },
                "additionalProperties": false
              },
              "geometry": {
                "type": "object",
                "properties": {
                  "size": {
                    "type": "array",
                    "items": {
                      "type": "number",
                      "minimum": 0
                    },
                    "description": "Size dimensions (length, width, height for box; radius for sphere/cylinder)"
                  },
                  "mesh": {
                    "type": "string",
                    "description": "Path to mesh file for mesh type objects"
                  }
                },
                "additionalProperties": false
              },
              "material": {
                "type": "object",
                "properties": {
                  "color": {
                    "type": "array",
                    "items": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1
                    },
                    "minItems": 3,
                    "maxItems": 4,
                    "description": "Material color (RGB or RGBA)"
                  },
                  "texture": {
                    "type": "string",
                    "description": "Path to texture file"
                  },
                  "friction": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "description": "Friction coefficient"
                  },
                  "restitution": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "description": "Restitution coefficient"
                  }
                },
                "additionalProperties": false
              },
              "mass": {
                "type": "number",
                "minimum": 0,
                "description": "Object mass in kg"
              },
              "collision": {
                "type": "boolean",
                "default": true,
                "description": "Whether object has collision detection"
              }
            },
            "additionalProperties": false
          },
          "description": "Static objects in the world"
        }
      },
      "additionalProperties": false
    },
    "robots": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["name", "model", "pose"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100,
            "description": "Robot name"
          },
          "model": {
            "type": "string",
            "minLength": 1,
            "maxLength": 500,
            "description": "Path to robot model file (.urdf, .sdf, .xacro)"
          },
          "pose": {
            "type": "object",
            "required": ["position", "orientation"],
            "properties": {
              "position": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "minItems": 3,
                "maxItems": 3,
                "description": "Initial position (x, y, z)"
              },
              "orientation": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "minItems": 4,
                "maxItems": 4,
                "description": "Initial orientation quaternion (x, y, z, w)"
              }
            },
            "additionalProperties": false
          },
          "namespace": {
            "type": "string",
            "pattern": "^[a-zA-Z0-9_/]+$",
            "description": "ROS namespace for this robot"
          },
          "controllers": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name", "type"],
              "properties": {
                "name": {
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 100,
                  "description": "Controller name"
                },
                "type": {
                  "type": "string",
                  "enum": ["joint_state", "position", "velocity", "effort", "trajectory"],
                  "description": "Controller type"
                },
                "joints": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "List of controlled joints"
                },
                "gains": {
                  "type": "object",
                  "description": "Controller gains",
                  "additionalProperties": {
                    "type": "number"
                  }
                }
              },
              "additionalProperties": false
            },
            "description": "Robot controllers configuration"
          },
          "sensors": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name", "type"],
              "properties": {
                "name": {
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 100,
                  "description": "Sensor name"
                },
                "type": {
                  "type": "string",
                  "enum": ["camera", "lidar", "imu", "gps", "encoder", "force_torque"],
                  "description": "Sensor type"
                },
                "frame": {
                  "type": "string",
                  "description": "Sensor frame ID"
                },
                "topic": {
                  "type": "string",
                  "description": "ROS topic for sensor data"
                },
                "parameters": {
                  "type": "object",
                  "description": "Sensor-specific parameters",
                  "additionalProperties": true
                }
              },
              "additionalProperties": false
            },
            "description": "Robot sensors configuration"
          },
          "plugins": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["name", "filename"],
              "properties": {
                "name": {
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 100,
                  "description": "Plugin name"
                },
                "filename": {
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 500,
                  "description": "Plugin library filename"
                },
                "parameters": {
                  "type": "object",
                  "description": "Plugin parameters",
                  "additionalProperties": true
                }
              },
              "additionalProperties": false
            },
            "description": "Gazebo plugins for this robot"
          }
        },
        "additionalProperties": false
      },
      "description": "Robots in the simulation"
    },
    "physics": {
      "type": "object",
      "required": ["engine", "maxStepSize", "realTimeFactor"],
      "properties": {
        "engine": {
          "type": "string",
          "enum": ["ode", "bullet", "simbody", "dart"],
          "default": "ode",
          "description": "Physics engine"
        },
        "maxStepSize": {
          "type": "number",
          "minimum": 0.001,
          "maximum": 0.1,
          "default": 0.001,
          "description": "Maximum physics step size in seconds"
        },
        "realTimeFactor": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 10,
          "default": 1,
          "description": "Real-time factor (1 = real-time)"
        },
        "gravity": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "minItems": 3,
          "maxItems": 3,
          "default": [0, 0, -9.81],
          "description": "Gravity vector (x, y, z)"
        },
        "solver": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["quick", "world"],
              "default": "quick",
              "description": "Solver type"
            },
            "iters": {
              "type": "number",
              "minimum": 1,
              "maximum": 100,
              "default": 50,
              "description": "Solver iterations"
            },
            "sor": {
              "type": "number",
              "minimum": 1,
              "maximum": 2,
              "default": 1.3,
              "description": "Successive over-relaxation parameter"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "gui": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Whether to enable GUI"
        },
        "fullscreen": {
          "type": "boolean",
          "default": false,
          "description": "Whether to run in fullscreen mode"
        },
        "width": {
          "type": "number",
          "minimum": 800,
          "maximum": 3840,
          "default": 1200,
          "description": "GUI window width"
        },
        "height": {
          "type": "number",
          "minimum": 600,
          "maximum": 2160,
          "default": 800,
          "description": "GUI window height"
        },
        "camera": {
          "type": "object",
          "properties": {
            "position": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "minItems": 3,
              "maxItems": 3,
              "description": "Initial camera position"
            },
            "target": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "minItems": 3,
              "maxItems": 3,
              "description": "Camera target point"
            },
            "fov": {
              "type": "number",
              "minimum": 10,
              "maximum": 120,
              "default": 60,
              "description": "Camera field of view"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "rendering": {
      "type": "object",
      "properties": {
        "engine": {
          "type": "string",
          "enum": ["ogre", "ogre2"],
          "default": "ogre2",
          "description": "Rendering engine"
        },
        "shadows": {
          "type": "boolean",
          "default": true,
          "description": "Whether to enable shadows"
        },
        "antiAliasing": {
          "type": "boolean",
          "default": true,
          "description": "Whether to enable anti-aliasing"
        },
        "textureQuality": {
          "type": "string",
          "enum": ["low", "medium", "high"],
          "default": "medium",
          "description": "Texture quality setting"
        }
      },
      "additionalProperties": false
    },
    "sensors": {
      "type": "object",
      "properties": {
        "noise": {
          "type": "object",
          "description": "Sensor noise parameters",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "mean": {
                "type": "number",
                "description": "Noise mean"
              },
              "stddev": {
                "type": "number",
                "description": "Noise standard deviation"
              }
            },
            "additionalProperties": false
          }
        },
        "updateRate": {
          "type": "number",
          "minimum": 1,
          "maximum": 1000,
          "default": 30,
          "description": "Default sensor update rate in Hz"
        }
      },
      "additionalProperties": false
    },
    "ros": {
      "type": "object",
      "properties": {
        "rosMasterUri": {
          "type": "string",
          "format": "uri",
          "description": "ROS master URI"
        },
        "rosNamespace": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_/]+$",
          "description": "ROS namespace for simulation"
        },
        "rosArgs": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Additional ROS arguments"
        }
      },
      "additionalProperties": false
    },
    "recording": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "description": "Whether to enable recording"
        },
        "format": {
          "type": "string",
          "enum": ["bag", "log"],
          "default": "bag",
          "description": "Recording format"
        },
        "topics": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Topics to record (empty = all)"
        },
        "duration": {
          "type": "number",
          "minimum": 0,
          "description": "Recording duration in seconds (0 = unlimited)"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
} 